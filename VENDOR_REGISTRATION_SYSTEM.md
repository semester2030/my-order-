# ğŸ¢ Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù… (Vendor Registration System) - B2B

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 25 ÙŠÙ†Ø§ÙŠØ± 2026  
**Ø§Ù„Ù†ÙˆØ¹:** Business-to-Business (B2B) Registration  
**Ø§Ù„Ù‡Ø¯Ù:** ØªØ³Ø¬ÙŠÙ„ Ø´Ø§Ù…Ù„ ÙˆØ¢Ù…Ù† Ù„Ù„Ù…Ø·Ø§Ø¹Ù… Ø§Ù„ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

---

## ğŸ“‹ **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø·Ø¹Ù…**

### **1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Basic Information)**
- âœ… **Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…** - Restaurant Name (Required)
- âœ… **Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ** - Trade Name (Required)
- âœ… **Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø¹Ù…** - Restaurant Type (Fine Dining, Premium Casual, Gourmet Desserts)
- âœ… **Ø§Ù„ÙˆØµÙ** - Description (Rich Text)
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ** - Phone Number (Required)
- âœ… **Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ** - Email (Required, Unique)
- âœ… **Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ** - Website (Optional)

---

### **2. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ (Commercial Registration)**
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ** - Commercial Registration Number (Required, Unique)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±** - Issue Date (Required)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡** - Expiry Date (Required)
- âœ… **ØµÙˆØ±Ø© Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ** - Commercial Registration Image (Required, PDF/Image)
- âœ… **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„** - Verification Status (Pending, Verified, Rejected)

---

### **3. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Location Information)**
- âœ… **Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„** - Full Address (Required)
- âœ… **Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©** - City (Required)
- âœ… **Ø§Ù„Ù…Ù†Ø·Ù‚Ø©** - District (Required)
- âœ… **Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ** - Postal Code (Optional)
- âœ… **Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª** - Coordinates (Latitude, Longitude) (Required)
- âœ… **Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹** - Map Picker (Interactive)

---

### **4. Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØªØ±Ø§Ø®ÙŠØµ (Certificates & Licenses)**

#### **Ø£) Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„ØµØ­Ø© (Health Certificate)**
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Number (Required)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±** - Issue Date (Required)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡** - Expiry Date (Required)
- âœ… **ØµÙˆØ±Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Image (Required, PDF/Image)
- âœ… **Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚** - Verification Status

#### **Ø¨) Ø±Ø®ØµØ© Ø§Ù„Ø¨Ù„Ø¯ÙŠØ© (Municipal License)**
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø±Ø®ØµØ©** - License Number (Required)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±** - Issue Date (Required)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡** - Expiry Date (Required)
- âœ… **ØµÙˆØ±Ø© Ø§Ù„Ø±Ø®ØµØ©** - License Image (Required, PDF/Image)
- âœ… **Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚** - Verification Status

#### **Ø¬) Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© (Food Safety Certificate)**
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Number (Optional)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±** - Issue Date (Optional)
- âœ… **ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡** - Expiry Date (Optional)
- âœ… **ØµÙˆØ±Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Image (Optional, PDF/Image)

#### **Ø¯) Ø´Ù‡Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰ (Other Certificates)**
- âœ… **Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª** - Array of Certificates
- âœ… **Ù†ÙˆØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Type
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©** - Certificate Number
- âœ… **Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®** - Issue/Expiry Dates
- âœ… **Ø§Ù„ØµÙˆØ±Ø©** - Certificate Image

---

### **5. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ (Contact Information)**
- âœ… **Ø§Ù„Ù…Ø§Ù„Ùƒ/Ø§Ù„Ù…Ø¯ÙŠØ±** - Owner/Manager Name (Required)
- âœ… **Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø§Ù„Ùƒ** - Owner Phone (Required)
- âœ… **Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø§Ù„Ùƒ** - Owner Email (Required)
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©** - ID Number (Required)
- âœ… **ØµÙˆØ±Ø© Ø§Ù„Ù‡ÙˆÙŠØ©** - ID Image (Required, PDF/Image)

---

### **6. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ (Banking Information)**
- âœ… **Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ** - Bank Name (Required)
- âœ… **Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨** - Account Number (Required)
- âœ… **IBAN** - IBAN Number (Required)
- âœ… **Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨** - Account Holder Name (Required)
- âœ… **ØµÙˆØ±Ø© ÙƒØ´Ù Ø§Ù„Ø­Ø³Ø§Ø¨** - Bank Statement (Optional, PDF/Image)

---

### **7. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹ (Payment Information)**
- âœ… **Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ÙØ¶Ù„Ø©** - Preferred Payment Method
- âœ… **Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ø¯ÙØ¹** - Payout Schedule (Weekly, Bi-weekly, Monthly)
- âœ… **Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©** - Commission Rate (Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…)

---

### **8. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ (Delivery Information)**
- âœ… **Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙˆØµÙŠÙ„** - Delivery Zones (Array of Zones)
- âœ… **Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„** - Delivery Fee (Per Zone)
- âœ… **ÙˆÙ‚Øª Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹** - Estimated Delivery Time
- âœ… **Ù†Ø·Ø§Ù‚ Ø§Ù„ØªÙˆØµÙŠÙ„** - Delivery Radius (KM)

---

### **9. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ³Ø§Ø¦Ø· (Media Information)**
- âœ… **Logo** - Restaurant Logo (Required, Image)
- âœ… **Cover Image** - Cover Image (Required, Image)
- âœ… **ØµÙˆØ± Ø§Ù„Ù…Ø·Ø¹Ù…** - Restaurant Images (Array, 3-10 images)
- âœ… **ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø·Ø¹Ù…** - Restaurant Video (Optional)

---

### **10. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ (Account Information)**
- âœ… **Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…** - Username (Required, Unique)
- âœ… **ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±** - Password (Required, Min 8 chars)
- âœ… **ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±** - Confirm Password (Required)
- âœ… **Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·** - Terms & Conditions (Required, Checkbox)
- âœ… **Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©** - Privacy Policy (Required, Checkbox)

---

## ğŸ—ï¸ **Ø§Ù„Ù‡ÙŠÙƒÙ„ ÙÙŠ Ø§Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯**

### **1. Vendor Entity (ØªØ­Ø¯ÙŠØ«)**

```typescript
// backend/src/modules/vendors/entities/vendor.entity.ts

@Entity('vendors')
export class Vendor {
  // Basic Info
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ unique: true })
  name: string;

  @Column({ name: 'trade_name', unique: true })
  tradeName: string;

  @Column({ type: 'enum', enum: VendorType })
  type: VendorType;

  @Column({ type: 'text', nullable: true })
  description: string;

  @Column({ name: 'phone_number' })
  phoneNumber: string;

  @Column({ unique: true })
  email: string;

  @Column({ nullable: true })
  website: string;

  // Commercial Registration
  @Column({ name: 'commercial_registration_number', unique: true })
  commercialRegistrationNumber: string;

  @Column({ name: 'commercial_registration_issue_date', type: 'date' })
  commercialRegistrationIssueDate: Date;

  @Column({ name: 'commercial_registration_expiry_date', type: 'date' })
  commercialRegistrationExpiryDate: Date;

  @Column({ name: 'commercial_registration_image' })
  commercialRegistrationImage: string;

  @Column({
    type: 'enum',
    enum: VerificationStatus,
    default: VerificationStatus.PENDING,
    name: 'commercial_registration_status',
  })
  commercialRegistrationStatus: VerificationStatus;

  // Location
  @Column('decimal', { precision: 10, scale: 8 })
  latitude: number;

  @Column('decimal', { precision: 11, scale: 8 })
  longitude: number;

  @Column()
  address: string;

  @Column()
  city: string;

  @Column({ nullable: true })
  district: string;

  @Column({ name: 'postal_code', nullable: true })
  postalCode: string;

  // Certificates
  @Column({ name: 'health_certificate_number', nullable: true })
  healthCertificateNumber: string;

  @Column({ name: 'health_certificate_issue_date', type: 'date', nullable: true })
  healthCertificateIssueDate: Date;

  @Column({ name: 'health_certificate_expiry_date', type: 'date', nullable: true })
  healthCertificateExpiryDate: Date;

  @Column({ name: 'health_certificate_image', nullable: true })
  healthCertificateImage: string;

  @Column({
    type: 'enum',
    enum: VerificationStatus,
    default: VerificationStatus.PENDING,
    name: 'health_certificate_status',
  })
  healthCertificateStatus: VerificationStatus;

  @Column({ name: 'municipal_license_number', nullable: true })
  municipalLicenseNumber: string;

  @Column({ name: 'municipal_license_issue_date', type: 'date', nullable: true })
  municipalLicenseIssueDate: Date;

  @Column({ name: 'municipal_license_expiry_date', type: 'date', nullable: true })
  municipalLicenseExpiryDate: Date;

  @Column({ name: 'municipal_license_image', nullable: true })
  municipalLicenseImage: string;

  @Column({
    type: 'enum',
    enum: VerificationStatus,
    default: VerificationStatus.PENDING,
    name: 'municipal_license_status',
  })
  municipalLicenseStatus: VerificationStatus;

  // Contact Info
  @Column({ name: 'owner_name' })
  ownerName: string;

  @Column({ name: 'owner_phone' })
  ownerPhone: string;

  @Column({ name: 'owner_email' })
  ownerEmail: string;

  @Column({ name: 'owner_id_number' })
  ownerIdNumber: string;

  @Column({ name: 'owner_id_image' })
  ownerIdImage: string;

  // Banking
  @Column({ name: 'bank_name', nullable: true })
  bankName: string;

  @Column({ name: 'bank_account_number', nullable: true })
  bankAccountNumber: string;

  @Column({ nullable: true })
  iban: string;

  @Column({ name: 'account_holder_name', nullable: true })
  accountHolderName: string;

  // Media
  @Column({ nullable: true })
  logo: string;

  @Column({ nullable: true })
  cover: string;

  @Column('simple-array', { nullable: true, name: 'restaurant_images' })
  restaurantImages: string[];

  // Status
  @Column({
    type: 'enum',
    enum: VendorStatus,
    default: VendorStatus.PENDING_APPROVAL,
    name: 'registration_status',
  })
  registrationStatus: VendorStatus;

  @Column({ default: true, name: 'is_active' })
  isActive: boolean;

  @Column({ default: true, name: 'is_accepting_orders' })
  isAcceptingOrders: boolean;

  // Timestamps
  @CreateDateColumn({ name: 'created_at' })
  createdAt: Date;

  @UpdateDateColumn({ name: 'updated_at' })
  updatedAt: Date;

  @Column({ name: 'approved_at', nullable: true })
  approvedAt: Date;

  @Column({ name: 'approved_by', nullable: true })
  approvedBy: string; // Admin ID

  // Relations
  @OneToMany(() => MenuItem, (menuItem) => menuItem.vendor)
  menuItems: MenuItem[];

  @OneToMany(() => Order, (order) => order.vendor)
  orders: Order[];

  @OneToMany(() => VendorCertificate, (cert) => cert.vendor)
  certificates: VendorCertificate[];
}
```

---

### **2. Vendor Certificate Entity (Ø¬Ø¯ÙŠØ¯)**

```typescript
// backend/src/modules/vendors/entities/vendor-certificate.entity.ts

@Entity('vendor_certificates')
export class VendorCertificate {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ name: 'vendor_id' })
  vendorId: string;

  @Column({ type: 'enum', enum: CertificateType })
  type: CertificateType;

  @Column({ name: 'certificate_number' })
  certificateNumber: string;

  @Column({ name: 'issue_date', type: 'date' })
  issueDate: Date;

  @Column({ name: 'expiry_date', type: 'date' })
  expiryDate: Date;

  @Column({ name: 'certificate_image' })
  certificateImage: string;

  @Column({
    type: 'enum',
    enum: VerificationStatus,
    default: VerificationStatus.PENDING,
  })
  status: VerificationStatus;

  @Column({ name: 'verified_at', nullable: true })
  verifiedAt: Date;

  @Column({ name: 'verified_by', nullable: true })
  verifiedBy: string; // Admin ID

  @CreateDateColumn({ name: 'created_at' })
  createdAt: Date;

  @UpdateDateColumn({ name: 'updated_at' })
  updatedAt: Date;

  @ManyToOne(() => Vendor, (vendor) => vendor.certificates)
  @JoinColumn({ name: 'vendor_id' })
  vendor: Vendor;
}
```

---

### **3. Enums**

```typescript
// backend/src/modules/vendors/enums/vendor-status.enum.ts

export enum VendorStatus {
  PENDING_APPROVAL = 'pending_approval',
  UNDER_REVIEW = 'under_review',
  APPROVED = 'approved',
  REJECTED = 'rejected',
  SUSPENDED = 'suspended',
}

// backend/src/modules/vendors/enums/verification-status.enum.ts

export enum VerificationStatus {
  PENDING = 'pending',
  VERIFIED = 'verified',
  REJECTED = 'rejected',
  EXPIRED = 'expired',
}

// backend/src/modules/vendors/enums/certificate-type.enum.ts

export enum CertificateType {
  HEALTH = 'health',
  MUNICIPAL = 'municipal',
  FOOD_SAFETY = 'food_safety',
  OTHER = 'other',
}
```

---

### **4. DTOs**

```typescript
// backend/src/modules/vendors/dto/register-vendor.dto.ts

export class RegisterVendorDto {
  // Basic Info
  @IsString()
  @IsNotEmpty()
  name: string;

  @IsString()
  @IsNotEmpty()
  tradeName: string;

  @IsEnum(VendorType)
  type: VendorType;

  @IsString()
  @IsOptional()
  description?: string;

  @IsString()
  @IsNotEmpty()
  @Matches(/^[0-9+\-\s()]+$/)
  phoneNumber: string;

  @IsEmail()
  @IsNotEmpty()
  email: string;

  @IsUrl()
  @IsOptional()
  website?: string;

  // Commercial Registration
  @IsString()
  @IsNotEmpty()
  commercialRegistrationNumber: string;

  @IsDateString()
  @IsNotEmpty()
  commercialRegistrationIssueDate: string;

  @IsDateString()
  @IsNotEmpty()
  commercialRegistrationExpiryDate: string;

  // Location
  @IsNumber()
  @IsNotEmpty()
  latitude: number;

  @IsNumber()
  @IsNotEmpty()
  longitude: number;

  @IsString()
  @IsNotEmpty()
  address: string;

  @IsString()
  @IsNotEmpty()
  city: string;

  @IsString()
  @IsOptional()
  district?: string;

  @IsString()
  @IsOptional()
  postalCode?: string;

  // Contact Info
  @IsString()
  @IsNotEmpty()
  ownerName: string;

  @IsString()
  @IsNotEmpty()
  ownerPhone: string;

  @IsEmail()
  @IsNotEmpty()
  ownerEmail: string;

  @IsString()
  @IsNotEmpty()
  ownerIdNumber: string;

  // Account
  @IsString()
  @IsNotEmpty()
  @MinLength(8)
  username: string;

  @IsString()
  @IsNotEmpty()
  @MinLength(8)
  password: string;

  @IsBoolean()
  @IsNotEmpty()
  @IsTrue()
  termsAccepted: boolean;

  @IsBoolean()
  @IsNotEmpty()
  @IsTrue()
  privacyAccepted: boolean;
}
```

---

### **5. Controller**

```typescript
// backend/src/modules/vendors/vendors.controller.ts

@Controller('vendors')
export class VendorsController {
  constructor(private readonly vendorsService: VendorsService) {}

  @Post('register')
  @ApiOperation({ summary: 'Register new vendor' })
  @UseInterceptors(FileFieldsInterceptor([
    { name: 'commercialRegistration', maxCount: 1 },
    { name: 'healthCertificate', maxCount: 1 },
    { name: 'municipalLicense', maxCount: 1 },
    { name: 'ownerId', maxCount: 1 },
    { name: 'logo', maxCount: 1 },
    { name: 'cover', maxCount: 1 },
    { name: 'restaurantImages', maxCount: 10 },
  ]))
  async register(
    @Body() dto: RegisterVendorDto,
    @UploadedFiles() files: {
      commercialRegistration?: Express.Multer.File[];
      healthCertificate?: Express.Multer.File[];
      municipalLicense?: Express.Multer.File[];
      ownerId?: Express.Multer.File[];
      logo?: Express.Multer.File[];
      cover?: Express.Multer.File[];
      restaurantImages?: Express.Multer.File[];
    },
  ) {
    return this.vendorsService.register(dto, files);
  }

  @Get('registration-status/:id')
  @ApiOperation({ summary: 'Check registration status' })
  async getRegistrationStatus(@Param('id') id: string) {
    return this.vendorsService.getRegistrationStatus(id);
  }
}
```

---

### **6. Service**

```typescript
// backend/src/modules/vendors/vendors.service.ts

@Injectable()
export class VendorsService {
  constructor(
    @InjectRepository(Vendor)
    private readonly vendorRepository: Repository<Vendor>,
    private readonly usersService: UsersService,
    private readonly fileUploadService: FileUploadService,
  ) {}

  async register(dto: RegisterVendorDto, files: any): Promise<Vendor> {
    // 1. Validate email uniqueness
    const existingVendor = await this.vendorRepository.findOne({
      where: { email: dto.email },
    });
    if (existingVendor) {
      throw new ConflictException('Email already registered');
    }

    // 2. Validate commercial registration number
    const existingReg = await this.vendorRepository.findOne({
      where: { commercialRegistrationNumber: dto.commercialRegistrationNumber },
    });
    if (existingReg) {
      throw new ConflictException('Commercial registration number already exists');
    }

    // 3. Upload files
    const uploadedFiles = await this.fileUploadService.uploadMultiple(files);

    // 4. Create vendor account
    const vendor = this.vendorRepository.create({
      ...dto,
      commercialRegistrationImage: uploadedFiles.commercialRegistration?.[0]?.path,
      healthCertificateImage: uploadedFiles.healthCertificate?.[0]?.path,
      municipalLicenseImage: uploadedFiles.municipalLicense?.[0]?.path,
      ownerIdImage: uploadedFiles.ownerId?.[0]?.path,
      logo: uploadedFiles.logo?.[0]?.path,
      cover: uploadedFiles.cover?.[0]?.path,
      restaurantImages: uploadedFiles.restaurantImages?.map(f => f.path),
      registrationStatus: VendorStatus.PENDING_APPROVAL,
    });

    const savedVendor = await this.vendorRepository.save(vendor);

    // 5. Create user account for vendor
    await this.usersService.createVendorUser({
      username: dto.username,
      email: dto.email,
      password: dto.password,
      vendorId: savedVendor.id,
      role: 'vendor',
    });

    // 6. Send notification to admin for review
    await this.notificationService.notifyAdminNewVendorRegistration(savedVendor);

    return savedVendor;
  }

  async getRegistrationStatus(vendorId: string) {
    const vendor = await this.vendorRepository.findOne({
      where: { id: vendorId },
      select: ['id', 'registrationStatus', 'createdAt', 'approvedAt'],
    });

    if (!vendor) {
      throw new NotFoundException('Vendor not found');
    }

    return {
      status: vendor.registrationStatus,
      submittedAt: vendor.createdAt,
      approvedAt: vendor.approvedAt,
      message: this.getStatusMessage(vendor.registrationStatus),
    };
  }

  private getStatusMessage(status: VendorStatus): string {
    const messages = {
      [VendorStatus.PENDING_APPROVAL]: 'Your registration is pending review. We will contact you soon.',
      [VendorStatus.UNDER_REVIEW]: 'Your registration is under review. Please wait for approval.',
      [VendorStatus.APPROVED]: 'Your registration has been approved. You can now log in.',
      [VendorStatus.REJECTED]: 'Your registration has been rejected. Please contact support.',
      [VendorStatus.SUSPENDED]: 'Your account has been suspended. Please contact support.',
    };
    return messages[status];
  }
}
```

---

## ğŸ¨ **Ø§Ù„Ù‡ÙŠÙƒÙ„ ÙÙŠ Frontend (Next.js)**

### **1. ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Registration Page)**
**Route:** `/register`

#### **Ø§Ù„Ø¨Ù†ÙŠØ©:**
```
register/
â”œâ”€â”€ page.tsx                    # Main Registration Page
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ BasicInfoStep.tsx       # Step 1: Basic Information
â”‚   â”œâ”€â”€ CommercialRegStep.tsx   # Step 2: Commercial Registration
â”‚   â”œâ”€â”€ LocationStep.tsx         # Step 3: Location
â”‚   â”œâ”€â”€ CertificatesStep.tsx    # Step 4: Certificates
â”‚   â”œâ”€â”€ ContactInfoStep.tsx     # Step 5: Contact Information
â”‚   â”œâ”€â”€ BankingStep.tsx         # Step 6: Banking
â”‚   â”œâ”€â”€ MediaStep.tsx           # Step 7: Media
â”‚   â””â”€â”€ AccountStep.tsx         # Step 8: Account
â””â”€â”€ hooks/
    â””â”€â”€ useVendorRegistration.ts
```

#### **Multi-Step Form:**
- âœ… **Step 1:** Basic Information
- âœ… **Step 2:** Commercial Registration
- âœ… **Step 3:** Location (with Map)
- âœ… **Step 4:** Certificates
- âœ… **Step 5:** Contact Information
- âœ… **Step 6:** Banking Information
- âœ… **Step 7:** Media (Logo, Cover, Images)
- âœ… **Step 8:** Account (Username, Password)

#### **Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
- âœ… **Progress Bar** - Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
- âœ… **Save Draft** - Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©
- âœ… **Validation** - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„ Ø®Ø·ÙˆØ©
- âœ… **File Upload** - Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø¹ Ù…Ø¹Ø§ÙŠÙ†Ø©
- âœ… **Map Picker** - Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø®Ø±ÙŠØ·Ø©
- âœ… **Terms & Conditions** - Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·

---

### **2. ØµÙØ­Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Registration Status)**
**Route:** `/register/status`

#### **Ø§Ù„Ù…Ø­ØªÙˆÙ‰:**
- âœ… **Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„** - Status Badge
- âœ… **Timeline** - Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
- âœ… **Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©** - Uploaded Documents
- âœ… **Ù…Ù„Ø§Ø­Ø¸Ø§Øª** - Admin Notes
- âœ… **Contact Support** - Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¯Ø¹Ù…

---

### **3. ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ (Documents Management)**
**Route:** `/profile/documents`

#### **Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:**
- âœ… **Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚** - View All Documents
- âœ… **Ø±ÙØ¹ ÙˆØ«Ø§Ø¦Ù‚ Ø¬Ø¯ÙŠØ¯Ø©** - Upload New Documents
- âœ… **ØªØ­Ø¯ÙŠØ« ÙˆØ«Ø§Ø¦Ù‚ Ù…Ù†ØªÙ‡ÙŠØ©** - Update Expired Documents
- âœ… **Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚** - Verification Status
- âœ… **ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡** - Expiry Alerts

---

## ğŸ” **Workflow Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© (Approval Workflow)**

### **1. Ø§Ù„Ù…Ø±Ø§Ø­Ù„:**
1. **Pending Approval** - ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
2. **Under Review** - Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
3. **Approved** - Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡
4. **Rejected** - Ù…Ø±ÙÙˆØ¶
5. **Suspended** - Ù…Ø¹Ù„Ù‚

### **2. Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:**
- âœ… **Admin Review** - Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
- âœ… **Document Verification** - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
- âœ… **Background Check** - ÙØ­Øµ Ø§Ù„Ø®Ù„ÙÙŠØ©
- âœ… **Approval/Rejection** - Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©/Ø§Ù„Ø±ÙØ¶
- âœ… **Notification** - Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø·Ø¹Ù…

---

## ğŸ“‹ **Checklist Ù„Ù„ØªÙ†ÙÙŠØ°**

### **Backend:**
- [ ] ØªØ­Ø¯ÙŠØ« Vendor Entity
- [ ] Ø¥Ù†Ø´Ø§Ø¡ VendorCertificate Entity
- [ ] Ø¥Ù†Ø´Ø§Ø¡ Enums (VendorStatus, VerificationStatus, CertificateType)
- [ ] Ø¥Ù†Ø´Ø§Ø¡ DTOs (RegisterVendorDto)
- [ ] ØªØ­Ø¯ÙŠØ« VendorsController
- [ ] ØªØ­Ø¯ÙŠØ« VendorsService
- [ ] Ø¥Ø¶Ø§ÙØ© File Upload Service
- [ ] Ø¥Ø¶Ø§ÙØ© Admin Approval Endpoints

### **Frontend:**
- [ ] ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Multi-step Form)
- [ ] ØµÙØ­Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
- [ ] ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
- [ ] File Upload Components
- [ ] Map Picker Component
- [ ] Validation Logic

---

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 25 ÙŠÙ†Ø§ÙŠØ± 2026  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… **COMPLETE REGISTRATION SYSTEM DESIGN**
